<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>未知</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<h2 id="nav_point_255" class="calibre7"><strong class="calibre6">21.4　用鸭子类型进行接口检查</strong></h2>
<p class="calibre1">在1.2节中，我们已经了解过鸭子类型的概念：</p>
<blockquote class="calibre8">
<p class="calibre1">“如果它走起路来像鸭子，叫起来也是鸭子，那么它就是鸭子。”</p>
</blockquote>
<p class="calibre1">鸭子类型是动态类型语言面向对象设计中的一个重要概念。利用鸭子类型的思想，不必借助超类型的帮助，就能在动态类型语言中轻松地实现本章提到的设计原则：面向接口编程，而不是面向实现编程。比如，一个对象如果有<code class="calibre9">push</code>和<code class="calibre9">pop</code>方法，并且提供了正确的实现，它就能被当作栈来使用；一个对象如果有<code class="calibre9">length</code>属性，也可以依照下标来存取属性，这个对象就可以被当作数组来使用。如果两个对象拥有相同的方法，则有很大的可能性它们可以被相互替换使用。</p>
<p class="calibre1">在<code class="calibre9">Object.prototype.toString.call( [] ) === '[object Array]'</code> 被发现之前，我们经常用鸭子类型的思想来判断一个对象是否是一个数组，代码如下：</p>
<pre class="Dai Ma Wu Xing Hao "><code class="calibre9">var isArray = function( obj ){
    return obj &amp;&amp;
        typeof obj === 'object' &amp;&amp;
        typeof obj.length === 'number' &amp;&amp;
        typeof obj.splice === 'function'
};

</code></pre>
<p class="calibre1">当然在JavaScript开发中，总是进行接口检查是不明智的，也是没有必要的，毕竟现在还找不到一种好用并且通用的方式来模拟接口检查，跟业务逻辑无关的接口检查也会让很多JavaScript程序员觉得不值得和不习惯。在Ross Harmes和Dustin Diaz合著的<em class="calibre18">Pro JavaScript Design Pattrns</em> 一书中，提供了一种根据鸭子类型思想模拟接口检查的方法，但这种基于双重循环的检查方法并不是很实用，而且只能检查对象的某个属性是否属于<code class="calibre9">Function</code>类型。</p>
</body></html>
