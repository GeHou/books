<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Vim实用技巧</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos202252" class="calibre_8"><span class="calibre1"><span class="bold">技巧37用参数列表将缓冲区分组</span></span></p><p class="calibre_9"> 参数列表易于管理，适用于对一批文件进行分组，使其更容易访问。用:argdo命令可以在参数列表中的每个文件上执行一条 Ex 命令。 </p><p class="calibre_7">我们首先用 Vim 打开一些文件：</p><p class="calibre_8"><span class="bold">➾ $ cd code/files/letters </span></p><p class="calibre_8"><span class="bold">➾ $ vim *.txt</span></p><p class="calibre_8"><span class="calibre6"> 《 5 files to edit </span></p><p class="calibre_7">在技巧36中，我们已经看到过<span class="bold">:ls</span>命令会列出缓冲区列表。</p><p class="calibre_7">现在，再让我们看看参数列表：</p><p class="calibre_8"><span class="bold">➾ :args</span></p><p class="calibre_8"><span class="calibre6"> 《 [a.txt] b.txt c.txt. d.txt e.txt </span></p><p class="calibre_7">参数列表记录了在启动时作为参数传递给Vim的文件列表。在本例中，我们只用了一个参数<span class="bold">*.txt</span>。然而，shell会对<span class="bold">*</span>通配符进行扩展，使其匹配5个文件，这5个文件我们已经在参数列表中看到了。输出中的“<span class="bold">[]</span>”字符则指明了参数列表中的哪个<a></a>文件是活动文件。</p><p class="calibre_7">与<span class="bold">:ls</span>命令所显示的列表相比，<span class="bold">:args</span>命令的输出比较简陋。如果你知道参数列表是<span class="bold">vi</span>的一个功能，而缓冲区列表是 Vim 引入的增强功能，那么就不会觉得奇怪了。但是，请给参数列表一个表现的机会，你会发现它是缓冲区列表的一个强力补充。</p><p class="calibre_7">就像其他许多功能一样，Vim 的参数列表功能也被增强了，只是名字还沿用原来的而已。实际上，我们可以在任意时刻改变参数列表的内容，就是说<span class="bold">:args</span>列表并不一定反映启动Vim时所传的参数。千万别被表面的名字给唬住了！（同样的情况请见“‘:compiler’与‘:make’不仅限于编译型语言”。）</p><p class="calibre_8"><span class="calibre2"><span class="bold">填充参数列表</span></span></p><p class="calibre_9">当不带参数运行<span class="bold">:args</span>命令时，它会打印当前参数列表的内容。另外，我们也可以用下列格式来设置参数列表的内容（参见<span class="bold">:h :args_f</span><img src="images/00243.jpg" class="calibre_10"/>）：</p><p class="calibre_"><img src="images/00230.jpg" class="calibre_92"/></p><p class="calibre_7"><span class="bold">{arglist}</span>可以包括文件名、通配符，甚至是一条 shell 命令的输出结果。我们将使用<span class="bold">files/mvc</span>目录作为演示，你可以在随本书发布的源文件中找到此目录。如果你打算照着做的话，请先切换到此目录，然后再启动 Vim：</p><p class="calibre_8"><span class="bold">➾$ cd code/files/mvc</span></p><p class="calibre_8"><span class="bold">➾$ vim</span></p><p class="calibre_9">要了解此目录树的结构，请参见技巧41。</p><p class="calibre_8"><span class="calibre2"><span class="bold">用文件名指定文件</span></span></p><p class="calibre_9">填充参数列表最简单的方式是逐一指定文件的名字：</p><p class="calibre_8"><span class="bold">➾ :args index.html app.js </span></p><p class="calibre_8"><span class="bold">➾ :args</span></p><p class="calibre_8"><span class="calibre6"> 《 [index.html] app.js </span></p><p class="calibre_7">如果只是想在列表里增加几个文件，用这种方式就行了。它的好处是可以指定文件的次序，但它也有一个缺点，那就是手动增加文件的工作量比较大。如果想往参数列表中加入大量文件，那么使用通配符会快得多。</p><p class="calibre_5">
<a></a>
</p><p class="calibre_8"><span class="calibre2"><span class="bold">用 Glob 模式指定文件</span></span></p><p class="calibre_9">通配符是一个占位标记，它代表了可用于文件或目录名称的字符。<span class="bold">*</span>符号用于匹配0个或多个字符，但它的范围仅局限于指定的目录，而不会递归其子目录（参见<span class="bold">:h wildcard</span><img src="images/00243.jpg" class="calibre_10"/>）；<span class="bold">**</span>通配符也匹配0个或多个字符，但它可以递归进入指定目录的子目录（参见<span class="bold">:h starstar-wildcard</span><img src="images/00243.jpg" class="calibre_10"/>）。</p><p class="calibre_7">我们可以把这两种通配符结合起来用，并加上部分文件名或目录名，以此构造一个模式（即所谓的glob模式），然后用它来匹配我们感兴趣的文件集合。下表总结了在<span class="bold">files/mvc</span>目录中满足指定glob模式的一些有代表性的文件（并未列出全部）：</p><p class="calibre3" style="margin:0pt; border:0pt; height:1em"> </p><table valign="top" class="calibre_18"><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20"><span class="bold">  Glob模式  </span>
</td><td colspan="1" rowspan="1" valign="top" class="calibre_20"><span class="bold">  所匹配的文件  </span>
</td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :args *.*   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  index.html<br class="calibre3"/>   app.js </td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :args **/*.js   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">   <p class="calibre_93"> app.js </p><p class="calibre_93"> lib/framework.js </p><p class="calibre_93"> app/controllers/Mailer.js  </p><p class="calibre_93"> ...etc   </p></td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :args **/*.*   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">   <p class="calibre_93"> app.js </p><p class="calibre_93"> index.html </p><p class="calibre_93"> lib/framework.js </p><p class="calibre_93"> lib/theme.css </p><p class="calibre_93"> app/controllers/Mailer.js  </p><p class="calibre_93"> ...etc   </p></td></tr></table><p class="calibre_6">就像可在<span class="bold">{arglist}</span>中使用多个文件名一样，我们也可以使用不止一个 glob模式。如果我们想构造一个只包含<span class="bold">.js</span>和<span class="bold">.css</span>文件，但不包含其他文件类型的参数列表，可以采用以下glob模式：</p><p class="calibre_8"><span class="bold">➾ :args **/*.js **/*.css</span></p><p class="calibre_8"><span class="calibre2"><span class="bold">用反引号结构指定文件</span></span></p><p class="calibre_9">在写这本书时，有时我想按照目录顺序把每一章的文件名加入到参数列表中。为达到这一目的，我维护了一个文本文件，每行保存一个文件名。下面的内容就节选自此文本文件：</p><p class="calibre_"><img src="images/00234.jpg" class="calibre_94"/></p><p class="calibre_7">然后，我就可以执行下面的命令，用该文件的内容填充参数列表：</p><p class="calibre_8"><span class="bold">➾ :args `cat .chapters`</span></p><p class="calibre_9">Vim 会在 shell 中执行反撇号（`）括起来的命令，然后再把<span class="bold">cat</span>命令的输出作为<span class="bold">:args</span>命令的参数。虽然本例是用<span class="bold">cat</span>命令获取<span class="bold">.chapters</span>文件的内容，但实际上我们可以用这种方式执行任意可用的shell命令。然而，此功能并不是所有系统都可用，更多细节请查阅<span class="bold">:h backtick-expansion</span><img src="images/00243.jpg" class="calibre_10"/>。</p><p class="calibre_8"><span class="calibre2"><span class="bold">使用参数列表</span></span></p><p class="calibre_9">参数列表比缓冲区列表更容易管理，这使其成为对缓冲区进行分组的理想方式。通过使用<span class="bold">:args {arglist}</span>命令，一下就可清空并重新设置参数列表，接着就可以用<span class="bold">:next</span>及<span class="bold">:prev</span>命令遍历参数列表中的文件，或是用<span class="bold">:argdo</span>命令在列表中的每个缓冲区上执行同一条命令。</p><p class="calibre_7">我的感觉是：缓冲区列表就像是我的计算机桌面（desktop），它永远是乱七八糟的；而参数列表则像一个整洁的独立工作区（workspace），只有在需要扩展空间时才会用到它。我们将会看到其他一些使用参数列表的例子，请参见技巧69和技巧96。</p><div class="mbp_pagebreak" id="calibre_pb_49"></div>
</body></html>
