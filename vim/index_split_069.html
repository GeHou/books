<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Vim实用技巧</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos339244" class="calibre_8"><span class="calibre1"><span class="bold">技巧59用无名寄存器实现删除、复制与粘贴操作</span></span></p><p class="calibre_9"> Vim的删除、复制与粘贴命令的设计初衷是帮助人们轻松完成日常工作。接下来，我们将研究几个可用Vim无名寄存器轻松解决的问题，最后，我们将看到一个任务，要想完成它，要求我们对Vim寄存器的工作原理有更深入的了解才行。 </p><p class="calibre_7">通常情况下，在讨论剪切、复制与粘贴这3组操作时，指的都是操作系统剪贴板。不过，在Vim的术语里，我们操作的是寄存器，而并非剪贴板。在技巧60中，我们<a></a>将看到Vim支持多组寄存器，并且还可以指定想用其中的哪一个。不过，先让我们看看用无名寄存器都能干些什么吧。</p><p class="calibre_8"><span class="calibre2"><span class="bold">调换字符</span></span></p><p class="calibre_9">我总爱拼错某些单词。久而久之，我发现自己会习惯性地输错某个单词，然后我会训练自己别再犯这样的错误。但有些拼写错误在所难免，最常见的拼写错误莫过于将两个字符的次序颠倒了，而Vim能够轻松修正此类错误。</p><p class="calibre_7">假设我们在输入本书书名时犯了一个次序错误：</p><p class="calibre_6"><img src="images/00105.jpg" class="calibre_153"/></p><p class="calibre_6">这次错误源于我们敲空格键敲得太快了，不过这很容易改正。在纠错过程中，首先，<span class="bold">F␣</span>命令将光标移到要置换的第一个字符上（参见技巧49）。然后，<span class="bold">x</span>命令把光标下的字符剪切下来，把它放到无名寄存器。最后，<span class="bold">p</span>命令将无名寄存器中的内容粘贴到光标后面。</p><p class="calibre_7">将最后两条命令组合在一起，即<span class="bold">xp</span>，可被用于“调换光标之后的两个字符”。</p><p class="calibre_8"><span class="calibre2"><span class="bold">调换文本行</span></span></p><p class="calibre_9">类似地，我们也能方便地调换两行文本的顺序。这一次，我们不是用<span class="bold">x</span>命令剪切当前字符，而是用<span class="bold">dd</span>命令剪切当前行，从而将其内容存入无名寄存器中：</p><p class="calibre_6"><img src="images/00240.jpg" class="calibre_154"/></p><p class="calibre_6"><span class="bold">p</span>命令知道我们正在处理的是一整行文本，因此，如我们所愿，它把无名寄存器<a></a>的内容粘贴至当前行的下一行。还记得吗，在上一个例子中，当我们按下<span class="bold">xp</span>时，<span class="bold">p</span>命令是将内容粘贴至光标之后的。</p><p class="calibre_7">把以上命令序列连起来，即<span class="bold">ddp</span>，可被用于“调换当前行和它的下一行”。</p><p class="calibre_8"><span class="calibre2"><span class="bold">创建文本行的副本</span></span></p><p class="calibre_9">假设我们想创建一行新的文本，内容与之前某行类似，只有一两处差异。为此，我们可以先创建一行已有文本的副本，以此作为再加工的模板。要在Vim中实现这一功能，需要我们先复制一行，然后紧接着进行粘贴：</p><p class="calibre_6"><img src="images/00063.jpg" class="calibre_155"/></p><p class="calibre_6">请注意<span class="bold">ddp</span>与<span class="bold">yyp</span>这两组按键操作的相似之处。前者是对文本行的剪切与粘贴操作，实际上是调换了两行的顺序。后者是针对行的复制与粘贴操作，即创建一行副本。</p><p class="calibre_8"><span class="calibre2"><span class="bold">糟糕！我弄丢了复制内容</span></span></p><p class="calibre_9">到目前为止，Vim的删除、复制与粘贴操作看起来都非常直观，这些操作使得我们的日常工作得以轻松完成。现在让我们再来看一个场景，这次完成起来可没那么顺利。示例如下：</p><p class="calibre_"><img src="images/00120.jpg" class="calibre_156"/></p><p class="calibre_7">我们打算复制<span class="bold">collection</span>至无名寄存器，并用刚刚复制的内容替换<span class="bold">somethingInTheWay</span>。表10-1展示了我们第一次尝试的过程。</p><p class="calibre_7">由于光标一开始就已经位于要复制的单词之上，因此，我们只需输入<span class="bold">yiw</span>即可将其复制到无名寄存器中。</p><p class="calibre_7">接下来，我们把光标移到要粘贴<span class="bold">“collection”</span>的位置，但在粘贴之前得先清理出一块空白区域才行。因此我们运行<span class="bold">diw</span>，将<span class="bold">somethingInTheWay</span>一词删除。</p><p class="calibre_5">
<a></a>
</p><blockquote class="calibre_26">
<span class="bold">表10-1 复制与粘贴 —— 第一次尝试</span>
</blockquote><p class="calibre_6"><img src="images/00016.jpg" class="calibre_157"/></p><p class="calibre_6">现在，我们可以按<span class="bold">P</span>键将无名寄存器的内容粘贴至当前光标前面了。但我们得到的单词是<span class="bold">“somethingInTheWay”</span>，而不是之前复制的<span class="bold">“collection”</span>。到底发生了什么事？</p><p class="calibre_7"><span class="bold">diw</span>命令不仅删除了单词，而且还将它拷贝到了无名寄存器。改用广为人知的术语来说，<span class="bold">diw</span>命令把该词剪切掉了。（更多关于该话题的讨论，请参见<span class="italic">Vim术语对照表</span>。）</p><p class="calibre_7">很明显，我们做错了什么。当运行<span class="bold">diw</span>命令时，无名寄存器的内容被覆盖了。这就是为什么我们按<span class="bold">P</span>时得到的是刚刚删除的单词，而不是之前复制的单词。</p><p class="calibre_7">为了解决这个问题，我们得深入了解Vim寄存器的工作原理才行。</p><div class="mbp_pagebreak" id="calibre_pb_79"></div>
</body></html>
