<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Vim实用技巧</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos295630" class="calibre_8"><span class="calibre1"><span class="bold">技巧51用精确的文本对象选择选区</span></span></p><p class="calibre_9"> 文本对象允许我们操作括号、被引用的文本、XML标签以及其他文本中的常见结构。 </p><p class="calibre_7">先看看下面的示例代码：</p><p class="calibre_"><img src="images/00066.jpg" class="calibre_135"/></p><p class="calibre_7">在上面的代码中，每个开括号字符 { 都对应一个闭括号字符 }， [ 和 ] 、&lt;和&gt;，以及HTML标签 <span class="bold">&lt;a&gt;</span>和<span class="bold">&lt;/a&gt;</span>也是一样。这段代码中也包含单引号及双引号，它们也是成对出现的。</p><p class="calibre_7">这些配对符号具有规整的格式，而Vim 能够理解其结构，并允许对它们所分隔的区域进行操作。文本对象就是基于结构定义的文本区域（参见<span class="bold">:h text-objects</span><img src="images/00243.jpg" class="calibre_10"/>）。通过使用文本对象，我们只需几个键就可以选择或操作一大段文本。</p><p class="calibre_7">假设光标位于花括号内部，而我们想高亮选中{}内部的文本，那么就可以用<span class="bold">vi}</span>：</p><p class="calibre_6"><img src="images/00085.jpg" class="calibre_136"/></p><p class="calibre_6">一般情况下，当我们使用可视模式时，选区的一端固定在一个特定字符上，而另一端可以自由移动；当我们使用<span class="bold">l</span>、<span class="bold">w</span>及<span class="bold">f{char}</span>这类动作命令时，会对高亮区域的活动端进行移动，使选区变大或缩小。</p><p class="calibre_7">但此处发生的情况却截然不同。当我们按下<span class="bold">vi}</span>时，Vim 会进入可视模式，并选中花括号 {} 所括起来的所有字符。光标放在哪儿都没关系，只要在调用<span class="bold">i}</span>文本对象时，光标在花括号内部就行了。</p><p class="calibre_7">我们也可以用其他的文本对象来扩大选区。例如，<span class="bold">a”</span>会选中由双引号括起来的字<a class="calibre2"></a>符范围，而<span class="bold">i&gt;</span>则会选中一对尖括号内的所有内容。</p><p class="calibre_7">Vim 的文本对象由两个字符组成，第一个字符永远是<span class="bold">i</span>或是<span class="bold">a</span>。我们一般说，以<span class="bold">i</span>开头的文本对象会选择分隔符内部的文本，而以<span class="bold">a</span>开头的文本对象则会选择包括分隔符在内的整个文本。为了便于记忆，可以把<span class="bold">i</span>想成“inside”，而把<span class="bold">a</span>想成“around”或“all”。</p><p class="calibre_7">再看一遍上面的例子，仔细体会一下文本对象是以<span class="bold">i</span>开头还是以<span class="bold">a</span>开头，特别需要注意的是<span class="bold">it</span>与<span class="bold">at</span>之间的区别。另外也要留意一下，在此例中<span class="bold">a]</span>将选区扩展到了多行。</p><p class="calibre_7">表8-1总结了部分 Vim 内置的文本对象。出于整洁起见，表中省略了一些重复的文本对象。例如，i(和i)等同，a[和a]也相同，你可以使用最适合自己的那种风格。</p><blockquote class="calibre_26">
<span class="bold">表8-1 分隔符文本对象</span>
</blockquote><p class="calibre_6"><img src="images/00107.jpg" class="calibre_137"/></p><p class="calibre_1">
<a class="calibre2"></a>
</p><p class="calibre_8"><span class="calibre3"><span class="bold">用文本对象执行操作</span></span></p><p class="calibre_9">可视模式适用于介绍文本对象，因为可以很容易看到发生的变化。然而，在操作符待决模式中使用文本对象，才能真正展现出它们的强大能力。</p><p class="calibre_7">文本对象自身并不是动作命令，我们不能用它们在文档中移动。但是我们却可以在可视模式及操作符待决模式中使用文本对象。记住：每当在命令语法里看到<span class="bold">{motion}</span>时，你也可以在这个地方使用文本对象，常见的例子包括<span class="bold">d{motion}</span>、<span class="bold">c{motion}</span>和<span class="bold">y{motion}</span>（更多命令，请参见表2-1）。</p><p class="calibre_7">让我们以<span class="bold">c{motion}</span>命令为例进行讲解。此命令会删除指定的文本，然后切换到插入模式（<span class="bold">:h c</span><img src="images/00243.jpg" class="calibre_10"/>）。我们将用它把下面文本中的 {url}替换为 #，然后再用一个文本标记把{title}替换掉：</p><p class="calibre_6"><img src="images/00131.jpg" class="calibre_138"/></p><p class="calibre_6">我们可以把<span class="bold">ci"</span>命令解读为“修改双引号内部的内容”，把<span class="bold">cit</span>命令解读为“修改标签内部的内容”。另外，我们也可以很容易地用<span class="bold">yit</span>命令拷贝标签内的文本，或者是用<span class="bold">dit</span>删除这些文本。</p><p class="calibre_8"><span class="calibre3"><span class="bold">结论</span></span></p><p class="calibre_9">这些命令都只需要3次按键，它们不仅简洁，而且使用方便，甚至也可以说这些命令都是自描述的（self-documenting）。之所以这样，是因为它们都采用了技巧12中提到的简单语法规则。</p><p class="calibre_7">在技巧49和技巧50中，我们学到了一些让我们精确移动光标的诀窍。不管是用<span class="bold">f{char}</span>查找单个字符，还是用<span class="bold">/target&lt;CR&gt;</span>查找若干字符，其工作模式都是一样的。我们先寻找合适的目标，瞄准，然后开火。如果做得好的话，一次移动就能命中目标。这些强大的移动功能允许我们花很少的力气就可以覆盖很大的区域。</p><p class="calibre_7">而文本对象则更进一层。如果说<span class="bold">f{char}</span>和<span class="bold">/pattern&lt;CR&gt;</span>命令如同单足飞踹，那么文本对象则像是一次攻击两个目标的剪刀腿，如图8-1所示。</p><p class="calibre_6"></p><p class="calibre_139"><img src="images/00160.jpg" class="calibre_140"/>
</p><p class="calibre_"><span class="calibre8">图8-1 Vim强大的移动功能可以做到非常精确</span></p><div class="mbp_pagebreak" id="calibre_pb_67"></div>
</body></html>
