<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Vim实用技巧</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos162893" class="calibre_8"><span class="calibre1"><span class="bold">技巧31重复上次的 Ex 命令</span></span></p><p class="calibre_9"> .命令可以重复上次的普通模式命令。然而，如果想重复上次的 Ex 命令的话，我们得使用@:才行。知道如何回退上次的命令永远是有价值的，因此本节也会讨论这一点。 </p><p class="calibre_7">在第1章中，我们见识过如何用<span class="bold">.</span>命令重复上次的修改。但是，<span class="bold">.</span>命令不会重复由 Vim 命令行中做出的修改。作为替代，我们可以用<span class="bold">@:</span>来重复上次的 Ex 命令（参见<span class="bold">:h @:</span><img src="images/00243.jpg" class="calibre_10"/>）。</p><p class="calibre_7">例如，下面两条命令在遍历缓冲区列表的条目时非常有用，用<span class="bold">:bn[ext]</span>可以在列表中逐项正向移动，而<span class="bold">:bp[revious]</span>命令则进行反向移动（技巧36详细讨论了缓冲区列表）。假设缓冲区列表中有大约十几个条目，而我们打算逐个查看每个缓冲区，因此可以输入一次下面的命令：</p><p class="calibre_5">
<a class="calibre2"></a>
</p><p class="calibre_8"><span class="bold">➾:bnext</span></p><p class="calibre_9">然后再用<span class="bold">@:</span>重复执行此命令。留意一下这和运行宏的相似之处（参见通过执行宏来回放命令序列），另外也需注意，<span class="bold">:</span>寄存器总是保存着最后执行的命令行命令（参见<span class="bold">:h quote_:</span> ）。在运行过一次<span class="bold">@:</span>后，后面就可以用<span class="bold">@@</span>命令来重复它。</p><p class="calibre_7">假设我们按得忘乎所以，执行了太多次<span class="bold">@:</span>命令以致于错过了目标。那要怎样才能改变方向往回跳呢？当然，我们可以执行<span class="bold">:bprevious</span>命令，但是想想如果以后再次执行<span class="bold">@:</span>命令会发生什么？没错，它会反向遍历缓冲区列表，恰恰与最初的方向相反。这会把人搞糊涂的。</p><p class="calibre_7">在这种情况下，更好的选择是使用<span class="bold">&lt;C-o&gt;</span>命令（参见技巧55）。每次运行<span class="bold">:bnext</span>命令（或用<span class="bold">@:</span>命令重复执行它）时，它都会在跳转列表中添加一条记录，而<span class="bold">&lt;C-o&gt;</span>命令会回到跳转列表的上条记录。</p><p class="calibre_7">我们可以执行一次<span class="bold">:bnext</span>，然后用<span class="bold">@:</span>重复任意多次；如果想往回跳，就用<span class="bold">&lt;C-o&gt;</span>命令。这样一来，如果接下来还想继续正向遍历缓冲区列表，就可以继续用<span class="bold">@:</span>命令。请牢记技巧4中提到的口诀：执行、重复、回退。</p><p class="calibre_7">Vim 为几乎所有功能都提供了相应的Ex命令。虽然用<span class="bold">@:</span>总是可以重复上一条Ex命令，但如果想回退其影响，却没有这种直截了当的方式。用本节提到的<span class="bold">&lt;C-o&gt;</span>命令，也能够回退<span class="bold">:next</span>、<span class="bold">:tnext</span>等命令的执行结果；然而对于表5-1中列出的Ex命令，则要用<span class="bold">u</span>键才能撤销其影响。</p><div class="mbp_pagebreak" id="calibre_pb_41"></div>
</body></html>
