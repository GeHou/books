<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Vim实用技巧</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos535427" class="calibre_8"><span class="calibre1"><span class="bold">技巧93使用子匹配重排CSV文件的字段</span></span></p><p class="calibre_9"> 在本节中，我们将会看到如何从查找模式中捕获子匹配，并在替换域中引用它们。 </p><p class="calibre_7">假设有一个CSV格式的文件，其中包含了一份含有电子邮箱地址以及姓名的列表。</p><p class="calibre_5">
<a class="calibre2"></a>
</p><p class="calibre_"><img src="images/00123.jpg" class="calibre_252"/></p><p class="calibre_7">现在假设我们想交换这些字段的次序，即把电子邮箱放到首列，其次是名字，最后一列为姓氏。通过使用以下substitute命令，我们可以做到这一点：</p><p class="calibre_8"><span class="bold">➾ /\v^([^,]*),([^,]*),([^,]*)$ </span></p><p class="calibre_8"><span class="bold">➾:%s//\3,\2,\1</span></p><p class="calibre_9">在这个模式中，<span class="bold">[^,]</span>会匹配除逗号以外的任何字符，因此，<span class="bold">([^,]*)</span>不仅会匹配0次或多次连续的非逗号字符，而且会把捕获到的结果当作子匹配（参见技巧75）。将此表达式重复3次，即可分别捕获CSV文件中3组字段中的每一列内容。</p><p class="calibre_7">我们可以通过记号 <span class="bold">\n<sup class="calibre5"><small id="filepos536876" class="calibre6"><a href="index_split_110.html#filepos558809" class="calibre2"><span class="calibre7"><span class="calibre_2"><span class="underline">(1)</span></span></span></a></small></sup></span>来引用这些子匹配。因此，在替换域中，<span class="bold">\1</span>表示姓氏，<span class="bold">\2</span>表示名字，<span class="bold">\3</span>表示电子邮箱。在把一行内容切分成单独的字段后，我们可以把它们按照设想的顺序进行重新排列，即<span class="bold">\3</span>，<span class="bold">\2</span>，<span class="bold">\1</span> —— 电子邮箱，名字，姓氏。</p><p class="calibre_7">命令的运行结果如下所示：</p><p class="calibre_"><img src="images/00245.jpg" class="calibre_253"/></p><div class="mbp_pagebreak" id="calibre_pb_121"></div>
</body></html>
