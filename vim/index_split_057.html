<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Vim实用技巧</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos280902" class="calibre_8"><span class="calibre1"><span class="bold">技巧49对字符进行查找</span></span></p><p class="calibre_9">Vim 的字符查找命令让我们可以在行内快速移动，并且它们能够在操作符待决模式下很好地工作。</p><p class="calibre_6"><span class="bold">f{char}</span>命令是在 Vim 中移动的最快方式之一。它会在光标位置与当前行行尾之间查找指定的字符，如果找到了，就会把光标移到此字符上；如果未找到，则保持光标不动（参见<span class="bold">:h f</span><img src="images/00243.jpg" class="calibre_10"/>）。</p><p class="calibre_7">听起来似乎比较复杂，但在实际操作中非常简单。来看看下面的操作：</p><p class="calibre_5">
<a class="calibre2"></a>
</p><p class="calibre_6"><img src="images/00102.jpg" class="calibre_120"/></p><p class="calibre_6">本例中，<span class="bold">fx</span>命令什么都不做。Vim 会正向查找字符“x”，但因为未能找到匹配的字符，因此光标保持不动。而<span class="bold">fo</span>命令找到了字符“o”，因此光标会被移到第一个匹配的字符上。</p><p class="calibre_7">如果我们是想让光标跳到单词“occurrence”的开头，那么不会再有比两次按键更快的方法了。<span class="bold">f{char}</span>命令非常的高效，当它像本例这样完美地工作时，你会觉得好像 Vim能够读到我们的想法一样。</p><p class="calibre_7">但是，<span class="bold">f{char}</span>命令并不是总能工作得这么好。假设我们想把光标移到单词“{char}”中的字符“c”上，看看用<span class="bold">fc</span>命令会发生什么：</p><p class="calibre_6"><img src="images/00236.jpg" class="calibre_121"/></p><p class="calibre_6">字符“c”在该行出现了好几次，因此这次我们无法直接命中目标，而是要试几次才能把光标移到想去的位置。幸运的是，我们不必一遍遍地重复输入<span class="bold">fc</span>命令。Vim会记录上次执行过的<span class="bold">f{char}</span>命令，随后用<span class="bold">;</span>命令就可以重复该命令了（参见<span class="bold">:h;</span><img src="images/00243.jpg" class="calibre_10"/>）。在本例中，我们得连按3次<span class="bold">;</span>才能使光标就位。</p><p class="calibre_7"><span class="bold">f{char}</span>和<span class="bold">;</span>结合在一起很强大，它让我们用很少的键就可以移动很远的距离。不过由于光标会移到哪里并不是很一目了然，因此我们很容易按<span class="bold">;</span>按得忘乎所以，导致错过目标。举个例子，假设我们想把光标移到单词“of”的开头：</p><p class="calibre_6"><img src="images/00059.jpg" class="calibre_122"/></p><p class="calibre_6">我们不小心跳过头了，这个时候，用 <span class="bold">,</span> 命令就可以再跳回来。此命令也会重复上次的<span class="bold">f{char}</span>命令，不过会按相反的方向进行查找（参见<span class="bold">:h,</span><img src="images/00243.jpg" class="calibre_10"/>）。还记得技巧4中提到的口诀吗？执行、重复、回退。我把<span class="bold">,</span> 当成一个安全网来用，当按<span class="bold">;</span>键按过头时，可以用它来回退。</p><p class="calibre_6">别将反向字符查找命令弃之不用</p><p class="calibre_6"> Vim 为键盘上几乎每个键都赋予了一个功能。如果想创建自定义映射项的话，那么该把它们绑定到哪个键上呢？Vim 提供了一个&lt;Leader&gt;，以此作为用户自定义命令的名字空间。下面的例子显示了如何利用&lt;Leader&gt;来创建我们的自定义映射项： </p><p class="calibre_"><img src="images/00096.jpg" class="calibre_123"/></p><p class="calibre_7"> 缺省的&lt;Leader&gt;键是\，因此我们可以按\n和\N来触发上面的自定义映射项。如果你想知道这两个按键映射项完成什么功能，请查阅:h zz。 </p><p class="calibre_7"> 在有些键盘上，\命令不太容易够到，因此 Vim 允许把&lt;Leader&gt;键映射为其他更方便的字符（参见:h mapleader<img src="images/00243.jpg" class="calibre_10"/>）。一个普遍的选择是把逗号设置为&lt;Leader&gt;键。如果你也是这么做的，我强烈建议你把反向字符查找命令映射为另一个键。下面给出了一个例子： </p><p class="calibre_"><img src="images/00111.jpg" class="calibre_124"/></p><p class="calibre_7"> ;和,命令是互为补充的，如果你去掉了其中一个，那么整个字符查找命令集的用处就会大打折扣了。 </p><p class="calibre_8"><span class="calibre3"><span class="bold">查找字符时，可以包含或是排除目标字符</span></span></p><p class="calibre_9"><span class="bold">f{char}</span>、<span class="bold">;</span>及<span class="bold">,</span>命令是字符查找命令集中的部分命令，下表列出了其中的所有命令：</p><p class="calibre_5"><img src="images/00124.jpg" class="calibre_125"/></p><p class="calibre_5">
<a class="calibre2"></a>
</p><p class="calibre_5"><img src="images/00147.jpg" class="calibre_126"/></p><p class="calibre_7">可以把<span class="bold">t{char}</span>及<span class="bold">T{char}</span>命令当成“直到查找到指定的字符为止”（search till the specified character）的命令，它们使光标停留在{char}前面的那个字符上，而<span class="bold">f{char}</span>和<span class="bold">F{char}</span>命令则把光标移动到指定字符上。</p><p class="calibre_7">为什么我们会同时需要这两种字符查找命令呢？乍一看原因并不是很明了。不过下例对它们在实际工作中的用途进行了诠释：</p><p class="calibre_6"><img src="images/00166.jpg" class="calibre_127"/></p><p class="calibre_6">刚开始，我们先把光标直接移到逗号上，因此使用了<span class="bold">f,</span>命令。接下来，我们想删除从此处到句尾的所有文本，但又不想删除句号，此时可以用<span class="bold">dt.</span>命令完成这项工作。</p><p class="calibre_7">还有另外一种做法，可以用<span class="bold">dfd</span>删除从光标位置到单词“Bond”的最后一个字母间的所有内容。虽然两种做法的最终结果都一样，但是我发现用<span class="bold">dt.</span>的话，不需要考虑太多东西。删除到字母“d”并不是一个通用模式，而删除句子的后半句话则是经常会做的操作。因此我们可以把<span class="bold">f,dt.</span>训练成手指的下意识动作。</p><p class="calibre_7">通常，当我想在当前行内快速移动光标时，我倾向于在普通模式中使用<span class="bold">f{char}</span> 和<span class="bold">F{char}</span>命令；当与<span class="bold">d{motion}</span>或<span class="bold">c{motion}</span>一起使用时，我会更倾向于使用<span class="bold">t{char}</span>及<span class="bold">T{char}</span>命令。换句话说，我在普通模式中会用<span class="bold">f</span>和<span class="bold">F</span>，而在操作符待决模式中则使用<span class="bold">t</span>和<span class="bold">T</span>。要了解更多细节，请参考技巧12及结识操作符待决模式。</p><p class="calibre_8"><span class="calibre3"><span class="bold">像Scrabble<sup class="calibre9"><small class="calibre6"><span class="bold">®</span></small></sup><sup class="calibre9"><small id="filepos288488" class="calibre6"><a href="index_split_062.html#filepos315287" class="calibre2"><span class="calibre10"><span class="bold"><span class="calibre_2"><span class="underline">(4)</span></span></span></span></a></small></sup>玩家那样思考</span></span></p><p class="calibre_9">字符查找命令能够节省很多次按键，但它们效率的高低却取决于所选的目标字符。就像Scrabble玩家所能告诉你的，某些字母出现的频率远高于其他字母。如果在用<span class="bold">f{char}</span>命令时，你养成了选择非常见字母的习惯，那么一次抵达目标的可能性就会大幅提高。</p><p class="calibre_7">假设我们想删除下句中唯一的形容词：</p><p class="calibre_"><img src="images/00193.jpg" class="calibre_128"/></p><p class="calibre_7">要用什么动作命令来把光标移到单词“excellent”上呢？如果我们把该词的第一个字母作为目标的话，需要先按<span class="bold">fe</span>，然后还得再输入<span class="bold">;;;</span>，才能跳过中间那些干扰字符。在本例中，更好的选择是用<span class="bold">fx</span>，这条命令一下就能让我们移动到此单词上，接下来就可以用<span class="bold">daw</span>命令删除该单词了（关于<span class="bold">aw</span>的详细介绍，请参见技巧52）。</p><p class="calibre_7">看一下你正在阅读的文本，它们几乎全是由小写字母组成的，而大写字母则要少得多，标点符号也很少。因此，在使用字符查找命令时，最好是选择出现频率比较低的字母作目标字符。多练习一下，你就能学会发现这些字符。</p><div class="mbp_pagebreak" id="calibre_pb_65"></div>
</body></html>
