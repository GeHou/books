<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Vim实用技巧</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos364660" class="calibre_8"><span class="calibre1"><span class="bold">技巧62把寄存器的内容粘贴出来</span></span></p><p class="calibre_9"> 普通模式下的粘贴命令，根据要插入文本的性质不同，执行结果也不同。确定要粘贴的文本区域是面向行的还是面向字符的，将有助于我们制定不同的策略。 </p><p class="calibre_7">在技巧59中，我们见识了用<span class="bold">xp</span>命令调换两字符的次序以及用<span class="bold">ddp</span>命令调换两行的顺序。尽管这两种情况都用到了<span class="bold">p</span>命令，但结果却略有差异。</p><p class="calibre_7"><span class="bold">p</span>命令旨在将寄存器中的文本粘贴到光标之后（参见<span class="bold">:h p</span><img src="images/00243.jpg" class="calibre_10"/>）。作为补充，Vim也提供了（大写的）<span class="bold">P</span>命令用于将文本插入到光标之前。至于当前光标前后的位置具体在哪，得根据将要插入的寄存器内容而定。</p><p class="calibre_7">以<span class="bold">xp</span>为例，寄存器仅包含一个字符。因此，<span class="bold">p</span>命令直接将寄存器的内容粘贴至当前光标所在位置之后。</p><p class="calibre_7">而在<span class="bold">ddp</span>的例子中，寄存器包含一整行文本。因此，<span class="bold">p</span>命令将寄存器内容粘贴<a class="calibre2"></a>至当前光标所在行的下一行。</p><p class="calibre_7">怎样才能知道<span class="bold">p</span>命令是把寄存器的文本粘贴到当前字符之后还是当前行之后呢？这取决于这个指定的寄存器是怎样被赋值的。面向行的复制或者删除操作（例如：<span class="bold">dd</span>、<span class="bold">yy</span>或者<span class="bold">dap</span>），将创建面向行的寄存器；而面向字符的复制或者删除操作（例如：<span class="bold">x</span>、<span class="bold">diw</span>或者<span class="bold">das</span>），则创建面向字符的寄存器。一般而言，使用<span class="bold">p</span>命令的结果会一目了然。（更多细节，请参见<span class="bold">:h linewise-register</span><img src="images/00243.jpg" class="calibre_10"/>。）</p><p class="calibre_8"><span class="calibre3"><span class="bold">粘贴面向字符的区域</span></span></p><p class="calibre_9">假设当前缺省的寄存器存有单词“collection”，我们想把它粘贴出来，用作函数调用的第一个参数。使用<span class="bold">p</span>还是<span class="bold">P</span>命令取决于当前光标的位置。缓冲区中的内容如下所示：</p><p class="calibre_"><img src="images/00086.jpg" class="calibre_165"/></p><p class="calibre_7">比较另外一种情况：</p><p class="calibre_"><img src="images/00216.jpg" class="calibre_124"/></p><p class="calibre_7">第一种情况要用<span class="bold">p</span>命令，而第二种情况应该用<span class="bold">P</span>命令。我认为这种方式很不直观，事实上，由于我经常犯此类错误，<span class="bold">puP</span>和<span class="bold">Pup</span>几乎成了下意识动作。</p><p class="calibre_7">我不喜欢被迫去判断面向字符的文本区域到底是放在光标之前还是之后。因此，较之使用普通模式的<span class="bold">p</span>和<span class="bold">P</span>命令，我有时更喜欢在插入模式中使用<span class="bold">&lt;C-r&gt;{register}</span>的映射项，来粘贴面向字符的文本区域。通过这种方式，寄存器的文本总会被插入至光标之前，就像我们在插入模式下手动输入它们一样。</p><p class="calibre_7">在插入模式下，我们可以通过输入<span class="bold">&lt;C-r&gt;"</span>来插入无名寄存器的内容，或者输入<span class="bold">&lt;C-r&gt;0</span>来插入复制专用寄存器的内容（更多细节，请参见技巧15）。这种方法也可以解决糟糕！我弄丢了复制内容中的问题。</p><p class="calibre_5"><img src="images/00042.jpg" class="calibre_166"/>
<a class="calibre2"></a>
<img src="images/00155.jpg" class="calibre_167"/></p><p class="calibre_7">使用<span class="bold">ciw</span>命令带来的额外好处是，此时用<span class="bold">.</span>命令可以把当前单词替换为“collection”。</p><p class="calibre_8"><span class="calibre3"><span class="bold">粘贴面向行的区域</span></span></p><p class="calibre_9">当要粘贴的内容来自于面向行的寄存器时，<span class="bold">p</span>和<span class="bold">P</span>命令会把它们粘贴至当前行的上一行或下一行。这一点比面向字符的行为更直观。</p><p class="calibre_7">Vim提供的<span class="bold">gp</span>和<span class="bold">gP</span>命令也值得关注，因为它们同样可以将文本粘贴至在当前行之前或之后。不同的是，它们会把光标的位置移到被粘贴出来的文本结尾而不是开头。当复制多行文本时，<span class="bold">gP</span>命令尤为管用，例如：</p><p class="calibre_6"><img src="images/00287.jpg" class="calibre_168"/></p><p class="calibre_6">我们可以把该文本的副本当作模板，再根据要求修改表中单元格的内容。<span class="bold">P</span>和<span class="bold">gP</span>命令都工作得很好，但有一点除外，前者会将光标移到被插入进来的文本上方，而<span class="bold">gP</span>命令会将光标移到第二段副本的位置，从而让我们可以方便地根据需要进行修改。</p><p class="calibre_5">
<a class="calibre2"></a>
</p><p class="calibre_8"><span class="calibre3"><span class="bold">结论</span></span></p><p class="calibre_9"><span class="bold">p</span>与<span class="bold">P</span>命令对于粘贴多行文本区域非常重要，但是对于小段的、面向字符的文本来讲，使用<span class="bold">&lt;C-r&gt;{register}</span>映射项的方式会更直观。</p><div class="mbp_pagebreak" id="calibre_pb_82"></div>
</body></html>
