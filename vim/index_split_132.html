<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Vim实用技巧</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos659087" class="calibre_8"><span class="calibre1"><span class="bold">技巧113掌握关键字的来龙去脉</span></span></p><p class="calibre_9"> 普通关键字自动补全会把来自于多个来源的内容编入其补全列表。我们可以对生成补全列表项的来源加以限定。 </p><p class="calibre_7">有几种自动补全的变体形式，将根据特定的文件或者文件集合生成它们各自的补全列表。而普通关键字自动补全会将这些补全列表加以组合。为了掌握普通关键字的来龙去脉，我们首先应该看一看几种更具有针对性的自动补全形式。</p><p class="calibre_8"><span class="calibre2"><span class="bold">缓冲区列表</span></span></p><p class="calibre_9">要填充自动补全单词列表，最简单的方法就是使用当前缓冲区中的单词。基于当<a></a>前文件关键字的补全功能就是这样实现的，它可以通过<span class="bold">&lt;C-x&gt;&lt;C-n&gt;</span>（参见<span class="bold">:h compl-current</span><img src="images/00243.jpg" class="calibre_10"/>）进行触发。当普通关键字的补全产生过多的补全建议，而你知道要找的单词就位于当前缓冲区之中时，采用此法将会很有成效。</p><p class="calibre_7">但如果当前缓冲区的内容本身就很少，将导致这种补全方式所能提供的补全建议也少。为了扩充补全列表的内容，我们可以让Vim将缓冲区列表中所有文件的关键字都加载进来。以下命令可用于查看缓冲区列表：</p><p class="calibre_8"><span class="bold">➾:ls!</span></p><p class="calibre_9">缓冲区列表代表了当前Vim会话所打开的所有文件。在生成普通关键字时，会用到列表中每个文件的内容。接下来我们将看到，即使不打开某个文件，也可以将其内容添加到自动补全的单词列表中来。</p><p class="calibre_8"><span class="calibre2"><span class="bold">包含文件</span></span></p><p class="calibre_9">大多数编程语言都提供了某种从外部文件或者代码库加载代码的方式。在C语言中，这一功能是通过<span class="bold">#include</span>指示符实现的，而Python使用<span class="bold">import</span>，Ruby则用<span class="bold">require</span>。假设我们正在编辑的文件，包含了一些来自其他代码库的代码。如果Vim可以在建立自动补全的单词列表时，将这些引用文件的内容加载进来的话，将对我们大有裨益。这恰好是我们通过<span class="bold">&lt;C-x&gt;&lt;C-i&gt;</span>触发关键字补全时所发生的事情（参见<span class="bold">:h compl-keyword</span><img src="images/00243.jpg" class="calibre_10"/>）。</p><p class="calibre_7">Vim本身就理解C语言包含文件的方式，但通过设置<span class="bold">‘include’</span>选项（参见<span class="bold">:h 'include'</span><img src="images/00243.jpg" class="calibre_10"/>），我们也可以让它了解其他语言的对应提示符。通常，文件类型（file-type）插件会对该选项进行设置。好消息是Vim在发布时本身就支持多种编程语言，因此一般情况下用不着修改该项设置，除非你正在使用某种尚未得到支持的语言。请试着打开某个Ruby或者Python文件，并且运行<span class="bold">:set include?</span>，你应该发现Vim已经知道如何去找此类语言的包含文件了。</p><p class="calibre_8"><span class="calibre2"><span class="bold">标签文件</span></span></p><p class="calibre_9">在第16章中，我们结识了Exuberant Ctags这个外部程序，它可以对源码进行扫描，找出里面的关键字，如函数名、类名，以及对应语言的其他重要结构。当ctags扫描某个代码库时，它会生成关键字的索引，该索引是按字母顺序排列的，可以用它来定位关键字。根据惯例，这些索引会被存入一个名为<span class="bold">tags</span>的文件中。</p><p class="calibre_7">之所以采用ctags来建立代码库的索引，主要原因在于它让浏览代码变得更容易。另外，标签文件还产出了一项有用的副产品，即一份可用于自动补全的关键字列表。我们可以用<span class="bold">&lt;C-x&gt;&lt;C-]&gt;</span>（参见<span class="bold">:h compl-tag</span><img src="images/00243.jpg" class="calibre_10"/>）命令将其调出来。</p><p class="calibre_7">当你要补全的单词属于编程语言对象（例如，函数名或者类名）时，标签自动补全可以很好地帮助我们过滤非语言因素。</p><p class="calibre_8"><span class="calibre2"><span class="bold">合而为一</span></span></p><p class="calibre_9">普通关键字自动补全，会把来自于缓冲区列表、包含文件以及标签文件的单词列表组合在一起，并生成补全建议。如果你想改变该功能的行为，请参见定制普通关键字自动补全。还记得么，用<span class="bold">&lt;C-n&gt;</span>组合键就可以触发普通关键字自动补全了，而更具针对性的补全方式则需要先按<span class="bold">&lt;C-x&gt;</span>，再按另一个组合键来触发。</p><p class="calibre_6">定制普通关键字自动补全</p><p class="calibre_6"> 我们可以通过‘complete’ 选项来定制普通关键字补全时所扫描的位置。该选项包含一组由逗号分隔的单个字符，当某个参数出现时，就意味着需要扫描该参数所代表的位置。该选项的缺省设置为complete=.,w,b,u,t,i。我们可以使用以下命令来禁止扫描所有的包含文件： </p><p class="calibre_8"><span class="bold">➾:set complete-=i</span></p><p class="calibre_9"> 或者，我们可以通过以下命令来激活拼写字典自动补全功能： </p><p class="calibre_8"><span class="bold">➾:set complete+=k</span></p><p class="calibre_9"> 请查阅:h 'complete'，以便了解各个参数的作用。 </p><div class="mbp_pagebreak" id="calibre_pb_151"></div>
</body></html>
