<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Vim实用技巧</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos609371" class="calibre_8"><span class="calibre1"><span class="bold">技巧105浏览Quickfix列表</span></span></p><p class="calibre_9">quickfix列表会保存一组针对单个或多个文件内容的位置信息。每一项记录可以是在执行 <span class="bold">:make</span> 时由编译器产生的出错信息，也可以是在执行 <span class="bold">:grep</span> 时找到的查找匹配。不论列表是如何生成的，我们都要能够浏览这些记录。在本节中，我们将仔细研究浏览quickfix列表的几种方式。</p><p class="calibre_6">通过查阅<span class="bold">:h quickfix</span><img src="images/00243.jpg" class="calibre_10"/>，我们可以找到一份详尽的命令列表，用于浏览quickfix列表。表17-1展示了其中最有用的几种命令及其用途。</p><p class="calibre_7">这些命令均以<span class="bold">:c</span>开头，而位置列表（参见结识位置列表）也有与这些命令类似的命令，只不过需要将起始的字符换成<span class="bold">:l</span>，例如：<span class="bold">:lnext</span>、<span class="bold">:lprev</span>等。<span class="bold">:ll</span> N命令用于跳转到位置列表的第<span class="bold">n</span>项，它是对上述规则的一种很自然的变通。</p><p class="calibre_5">
<a class="calibre2"></a>
</p><blockquote class="calibre_26">
<span class="bold">表17-1 浏览 Quickfix 列表的命令</span>
</blockquote><p class="calibre4" style="margin:0pt; border:0pt; height:1em"> </p><table valign="top" class="calibre_18"><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20"><span class="bold">  命令  </span>
</td><td colspan="1" rowspan="1" valign="top" class="calibre_20"><span class="bold">    </span>
</td><td colspan="1" rowspan="1" valign="top" class="calibre_20"><span class="bold">  用途  </span>
</td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :cnext   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">     </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  跳转到下一项   </td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :cprev   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">     </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  跳转到上一项   </td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :cfirst   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">     </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  跳转到第一项   </td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :clast   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">     </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  跳转到最后一项   </td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :cnfile   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">     </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  跳转到下一个文件中的第一项   </td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :cpfile   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">     </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  跳转到上一个文件中的最后一项   </td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :cc N   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">     </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  跳转到第n项   </td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :copen   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">     </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  打开quickfix窗口   </td></tr><tr valign="top" class="calibre_19"><td colspan="1" rowspan="1" valign="top" class="calibre_20">  :cclose   </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">     </td><td colspan="1" rowspan="1" valign="top" class="calibre_20">  关闭quickfix窗口   </td></tr></table><p class="calibre_6">结识位置列表</p><p class="calibre_6"> 对于每一条用于填充quickfix列表的命令，都有一条对应的命令，把结果保存到位置列表。:make、:grep以及:vimgrep会使用quickfix列表，类似地，:lmake、:lgrep以及:lvimgrep将使用位置列表。二者有何不同呢？区别就在于，在任一特定的时刻，只能有一个quickfix列表，而位置列表却要多少有多少。 </p><p class="calibre_7"> 假设我们根据技巧107中的步骤，完成了外部编译器的配置，这样一来，当我们在某个JavaScript文件中运行:make时，Vim就会调用JSLint来验证该文件的内容。现在假设我们用两个分割窗口分别打开两个不同的JavaScript文件。当我们运行:lmake检查当前窗口的内容时，任何错误信息都将被保存至位置列表。紧接着，我们切换到另一个窗口，并再次运行:lmake。此时，Vim不会覆盖已有的位置列表，而是会创建一个新的列表。到目前为止，我们得到了两个位置列表，并且分别保存着来自两个不同JavaScript文件的错误信息。 </p><p class="calibre_7"> 任何与位置列表交互的命令（:lnext、:lprev等），仅操作与当前活动窗口相关联的那个位置列表。而Vim全局可见的quickfix列表则与之形成了鲜明对比。不论哪个标签页或者窗口处于活动状态，一旦运行 :copen，quickfix窗口都将显示同一份列表。 </p><p class="calibre_5">
<a class="calibre2"></a>
</p><p class="calibre_8"><span class="calibre3"><span class="bold">Quickfix的基本移动命令</span></span></p><p class="calibre_9">通过 <span class="bold">:cnext</span>与<span class="bold">:cprevious</span>这两条命令，我们可以向下或者向上遍历整个quickfix列表。如果我们想直接跳转到列表的起始或结尾项，可以用<span class="bold">:cfirs</span>t与<span class="bold">:clast</span>命令分别实现。由于我们需要大量地使用这4条命令，因此将它们映射成更顺手的快捷键不失为一个好主意。请参见创建快速遍历Vim列表的按键映射项中的相关建议。</p><p class="calibre_8"><span class="calibre3"><span class="bold">Quickfix的快速前进/后退命令</span></span></p><p class="calibre_9">无论是<span class="bold">:cnext</span>还是<span class="bold">:cprev</span>，都可以在其前面附加执行次数。因此，我们可以像下面这样每次间隔5项进行浏览，而不是依次浏览quickfix列表中的每一项：</p><p class="calibre_8"><span class="bold">➾:5cnext</span></p><p class="calibre_9">假设我们在浏览quickfix列表的过程中发现，尽管当前的文件存在多处匹配，却没有一处是我们想要的。在此场景中，与其每次浏览一项（甚至是10项），还不如跳过当前文件中的所有结果。<span class="bold">cnfile</span>命令就是做这个用的。正如你预期的那样，<span class="bold">:cpfile</span>会执行反向移动，即直接跳转到上一个文件的最后一项quickfix记录。</p><p class="calibre_8"><span class="calibre3"><span class="bold">使用Quickfix窗口</span></span></p><p class="calibre_9">通过运行<span class="bold">:copen</span>，我们可以打开一个包含<span class="bold">quickfix</span>列表内容的窗口。在某些方面，此窗口就像是一个普通的Vim缓冲区，分别可以用<span class="bold">k</span>、<span class="bold">j</span>两键进行上、下滚动，甚至还可以对quickfix列表中的内容进行查找。</p><p class="calibre_7">另外，quickfix窗口也有其特别之处。如果我们将光标置于某条列表项并按 <span class="bold">&lt;CR&gt;</span>键的话，Vim将会打开相应的文件，并将光标置于包含匹配结果的那一行上。文件会显示在quickfix窗口上方的窗口中，但如果该文件已经在当前标签页的某个窗口中打开了，那么就会复用该缓冲区。</p><p class="calibre_5">
<a class="calibre2"></a>
</p><p class="calibre_7"> 注意：quickfix窗口中的每一行都对应着quickfix列表的一项记录。如果我们运行:cnext的话，quickfix窗口中的光标位置将会向下移动一行，即使它不是活动窗口也不例外。反之，当我们通过操作quickfix窗口跳转到quickfix列表中的某一项记录之后，一旦再次运行:cnext，就会跳转到刚才所选中条目的后一项上。通过quickfix窗口选中某一项就好像运行了:cc[nr]命令，只不过采用的是更直观的可视化界面而已。 </p><p class="calibre_7">当quickfix窗口处于活动状态时，我们可以像平常一样使用 :q将其关闭。但如果其他窗口是活动窗口的话，我们也可以通过 :cclose将其关闭。</p><div class="mbp_pagebreak" id="calibre_pb_139"></div>
</body></html>
