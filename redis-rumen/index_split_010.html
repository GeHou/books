<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Redis入门指南（第2版）</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<blockquote id="filepos76819" class="calibre_11"><a href="index_split_000.html#filepos3632"><span class="calibre2"><span class="bold"><span class="calibre_2">2.3 Redis命令行客户端</span></span></span></a></blockquote><p class="calibre_14">还记得我们刚才编译出来的redis-cli程序吗？redis-cli（Redis Command Line Interface）是Redis自带的基于命令行的Redis客户端，也是我们学习和测试Redis的重要工具，本书后面会使用它来讲解Redis各种命令的用法。</p><p class="calibre_9">本节将会介绍如何通过redis-cli向Redis发送命令，并且对Redis命令返回值的不同类型进行简单介绍。</p><p id="filepos77473" class="calibre_6"><a href="index_split_000.html#filepos3825"><span class="calibre6"><span class="bold"><span class="calibre_2">2.3.1 发送命令</span></span></span></a></p><p class="calibre_14">通过redis-cli向Redis发送命令有两种方式，第一种方式是将命令作为redis-cli的参数执行，比如在2.2.2节中用过的 redis-cli SHUTDOWN。redis-cli执行时会自动按照默认配置（服务器地址为127.0.0.1，端口号为6379）连接Redis，通过-h和-p参数可以自定义地址和端口号：</p><p class="calibre_9">$ redis-cli -h 127.0.0.1 -p 6379</p><p class="calibre_9">Redis提供了PING命令来测试客户端与Redis的连接是否正常，如果连接正常会收到回复PONG。如：</p><p class="calibre_9">$ redis-cli PING</p><p class="calibre_9">PONG</p><p class="calibre_9">第二种方式是不附带参数运行 redis-cli，这样会进入交互模式，可以自由输入命令，例如：</p><p class="calibre_9">$ redis-cli</p><p class="calibre_9">redis 127.0.0.1:6379&gt; PING</p><p class="calibre_9">PONG</p><p class="calibre_9">redis 127.0.0.1:6379&gt; ECHO hi</p><p class="calibre_9">"hi"</p><p class="calibre_9">这种方式在要输入多条命令时比较方便，也是本书中主要采用的方式。为了简便起见，后文中我们将用 redis&gt;表示 redis 127.0.0.1:6379&gt;。</p><p id="filepos79038" class="calibre_6"><a href="index_split_000.html#filepos4021"><span class="calibre6"><span class="bold"><span class="calibre_2">2.3.2 命令返回值</span></span></span></a></p><p class="calibre_14">在大多数情况下，执行一条命令后我们往往会关心命令的返回值，如 1.2.4 节中的HGET命令的返回值就是我们需要的指定键的title字段的值。命令的返回值有5种类型，对于每种类型redis-cli的展现结果都不同，下面分别说明。</p><p class="calibre_9">1．状态回复</p><p class="calibre_9">状态回复（status reply）是最简单的一种回复，比如向 Redis 发送 SET 命令设置某个键的值时，Redis会回复状态OK表示设置成功。另外之前演示的对PING命令的回复PONG也是状态回复。状态回复直接显示状态信息，如：</p><p class="calibre_9">redis&gt; PING</p><p class="calibre_9">PONG</p><p class="calibre_9">2．错误回复</p><p class="calibre_9">当出现命令不存在或命令格式有错误等情况时 Redis 会返回错误回复（error reply）。错误回复以(error)开头，并在后面跟上错误信息。如执行一个不存在的命令：</p><p class="calibre_9">redis&gt; ERRORCOMMEND</p><p class="calibre_9">(error) ERR unknown command 'ERRORCOMMEND'</p><p class="calibre_9">在2.6版本时，错误信息均是以“ERR”开头，而在2.8版以后，部分错误信息会以具体的错误类型开头，如：</p><p class="calibre_9">redis&gt; LPUSH key 1</p><p class="calibre_9">(integer) 1</p><p class="calibre_9">redis&gt; GET key</p><p class="calibre_9">(error) WRONGTYPE Operation against a key holding the wrong kind of value</p><p class="calibre_9">这里错误信息开头的“WRONGTYPE”就表示类型错误，这个改进使得在调试时能更容易地知道遇到的是哪种类型的错误。</p><p class="calibre_9">3．整数回复</p><p class="calibre_9">Redis 虽然没有整数类型，但是却提供了一些用于整数操作的命令，如递增键值的INCR命令会以整数形式返回递增后的键值。除此之外，一些其他命令也会返回整数，如可以获取当前数据库中键的数量的 DBSIZE命令等。整数回复（integer reply）以(integer)开头，并在后面跟上整数数据：</p><p class="calibre_9">redis&gt; INCR foo</p><p class="calibre_9">(integer) 1</p><p class="calibre_9">4．字符串回复</p><p class="calibre_9">字符串回复（bulk reply）是最常见的一种回复类型，当请求一个字符串类型键的键值或一个其他类型键中的某个元素时就会得到一个字符串回复。字符串回复以双引号包裹：</p><p class="calibre_9">redis&gt; GET foo</p><p class="calibre_9">"1"</p><p class="calibre_9">特殊情况是当请求的键值不存在时会得到一个空结果，显示为(nil)。如：</p><p class="calibre_9">redis&gt; GET noexists</p><p class="calibre_9">(nil)</p><p class="calibre_9">5．多行字符串回复</p><p class="calibre_9">多行字符串回复（multi-bulk reply）同样很常见，如当请求一个非字符串类型键的元素列表时就会收到多行字符串回复。多行字符串回复中的每行字符串都以一个序号开头，如：</p><p class="calibre_9">redis&gt; KEYS *</p><p class="calibre_9">1) "bar"</p><p class="calibre_9">2) "foo"</p><p class="calibre_9">提示 KEYS命令的作用是获取数据库中符合指定规则的键名，由于读者的Redis中还没有存储数据，所以得到的返回值应该是（empty list or set）。3.1 节会具体介绍KEYS命令，此处读者只需了解多行字符串回复的格式即可。</p><div class="mbp_pagebreak" id="calibre_pb_10"></div>
</body></html>
